---

title: Philander 2014


keywords: fastai
sidebar: home_sidebar

summary: "Full replication"
description: "Full replication"
nb_path: "35_philander2014.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 35_philander2014.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This notebook shows how gamba can be used to reproduce findings from Philander's 2014 study on data mining methods for detecting high-risk gamblers.</p>
<ul>
<li><a href="http://www.thetransparencyproject.org/download_index.php">Data Download (thetransparencyproject.org)</a></li>
<li><a href="">Data Description</a></li>
<li><a href="https://www.tandfonline.com/doi/abs/10.1080/14459795.2013.841721">Original Paper</a></li>
</ul>
<p>It uses data available through the transaparency project above, and performs eight distinct supervised machine learning techniques.</p>
<p><strong>Note:</strong> given the high dimensionality of this data (17), the sample size (530) doesn't meet the <a href="https://youtu.be/Dc0sr0kdBVI?t=3414">rule of thumb</a> that 10x17 (or 1700) observations are required for learning to be generalisable. This means that the ouputs of the methods below may change drastically upon repeated executions, and comparison to the original may not be meaningful.</p>
<p>To begin, import gamba as usual;</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">gamba</span> <span class="k">as</span> <span class="nn">gb</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">philander_data</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">prepare_philander_data</span><span class="p">(</span><span class="s1">&#39;AnalyticDataSet_HighRisk.txt&#39;</span><span class="p">,</span> <span class="n">loud</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">train_measures</span><span class="p">,</span> <span class="n">test_measures</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">measures</span><span class="o">.</span><span class="n">split_measures_table</span><span class="p">(</span><span class="n">philander_data</span><span class="p">,</span> <span class="n">frac</span><span class="o">=.</span><span class="mi">696</span><span class="p">,</span> <span class="n">loud</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">train_measures</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>530 players loaded
train:test
 369 : 161 ready
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>player_id</th>
      <th>country</th>
      <th>gender</th>
      <th>age</th>
      <th>total_wagered</th>
      <th>num_bets</th>
      <th>frequency</th>
      <th>duration</th>
      <th>bets_per_day</th>
      <th>net_loss</th>
      <th>intensity</th>
      <th>variability</th>
      <th>frequency_1m</th>
      <th>trajectory</th>
      <th>z_intensity</th>
      <th>z_variability</th>
      <th>z_frequency</th>
      <th>z_trajectory</th>
      <th>self_exclude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>21</th>
      <td>1325917</td>
      <td>276</td>
      <td>1</td>
      <td>53</td>
      <td>93.3400</td>
      <td>53</td>
      <td>22</td>
      <td>419</td>
      <td>2.409091</td>
      <td>14.9900</td>
      <td>1.000000</td>
      <td>3.685557</td>
      <td>4</td>
      <td>-0.230259</td>
      <td>-0.622850</td>
      <td>-0.243764</td>
      <td>-0.239622</td>
      <td>-0.218470</td>
      <td>1</td>
    </tr>
    <tr>
      <th>283</th>
      <td>1366865</td>
      <td>792</td>
      <td>1</td>
      <td>24</td>
      <td>160.7257</td>
      <td>14</td>
      <td>5</td>
      <td>260</td>
      <td>2.800000</td>
      <td>105.5627</td>
      <td>3.666667</td>
      <td>32.369628</td>
      <td>3</td>
      <td>0.630566</td>
      <td>-0.111173</td>
      <td>-0.057883</td>
      <td>-0.415612</td>
      <td>0.980193</td>
      <td>1</td>
    </tr>
    <tr>
      <th>253</th>
      <td>1363496</td>
      <td>300</td>
      <td>1</td>
      <td>29</td>
      <td>1834.5600</td>
      <td>196</td>
      <td>71</td>
      <td>390</td>
      <td>2.760563</td>
      <td>420.3200</td>
      <td>3.000000</td>
      <td>7.972459</td>
      <td>3</td>
      <td>-0.385017</td>
      <td>-0.239092</td>
      <td>-0.215983</td>
      <td>-0.415612</td>
      <td>-0.433965</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">log_r</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">machine_learning</span><span class="o">.</span><span class="n">logistic_regression</span><span class="p">(</span><span class="n">train_measures</span><span class="p">,</span> <span class="n">test_measures</span><span class="p">,</span> <span class="s1">&#39;self_exclude&#39;</span><span class="p">)</span>
<span class="n">lasso_l</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">machine_learning</span><span class="o">.</span><span class="n">lasso_logistic_regression</span><span class="p">(</span><span class="n">train_measures</span><span class="p">,</span> <span class="n">test_measures</span><span class="p">,</span> <span class="s1">&#39;self_exclude&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Neural-Networks">Neural Networks<a class="anchor-link" href="#Neural-Networks"> </a></h2><p>The following cell uses the <a href="https://keras.io">Keras</a> library to create and train some neural networks as described in the study. The original study uses the R <a href="https://cran.r-project.org/web/packages/nnet/nnet.pdf#Rfn.optim">nnet</a> and <a href="https://cran.r-project.org/web/packages/caret/vignettes/caret.html">caret</a> packages, <a href="https://stackoverflow.com/questions/42417948/how-to-use-size-and-decay-in-nnet">this stackoverflow post</a> was helpful in understanding the original parameters.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Framing the self_exclude label (0 or 1) as a regression problem means creating a neural network with a single output node and clipping the prediction. The classification version of the neural network used in the original analysis uses an identical network topology but passes two strings as values instead of a 1 or 0. This should in theory have no substantial difference on the performance of the network (given the sample size and identical architectures).</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Activation</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1"># classification = discrete output</span>
<span class="c1"># regression = continuous output</span>

<span class="k">def</span> <span class="nf">simple_classification_neural_network</span><span class="p">(</span><span class="n">train_measures</span><span class="p">,</span> <span class="n">test_measures</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
    
    <span class="n">train_data</span> <span class="o">=</span> <span class="n">train_measures</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;player_id&#39;</span><span class="p">,</span> <span class="n">label</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">train_labels</span> <span class="o">=</span> <span class="n">train_measures</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
    <span class="n">test_data</span> <span class="o">=</span> <span class="n">test_measures</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;player_id&#39;</span><span class="p">,</span><span class="n">label</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">test_labels</span> <span class="o">=</span> <span class="n">test_measures</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">,</span> <span class="n">input_dim</span> <span class="o">=</span> <span class="mi">17</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s1">&#39;relu&#39;</span><span class="p">))</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">units</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">&#39;sigmoid&#39;</span><span class="p">))</span>

    <span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span> <span class="o">=</span> <span class="s1">&#39;adam&#39;</span><span class="p">,</span> 
                  <span class="n">loss</span> <span class="o">=</span> <span class="s1">&#39;mean_squared_error&#39;</span><span class="p">,</span>
                  <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>

    <span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">,</span> 
                        <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">epochs</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
                        <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">test_data</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">),</span>
                        <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># now make a prediction and clip the values to 0 or 1 as in the original code</span>
    <span class="n">raw_prediction</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data</span><span class="p">)</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">raw_prediction</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span>
    
    <span class="k">return</span> <span class="n">prediction</span>

<span class="n">test_labels</span> <span class="o">=</span> <span class="n">test_measures</span><span class="p">[</span><span class="s1">&#39;self_exclude&#39;</span><span class="p">]</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1">#nn_r = shallow_neural_network(train_measures, test_measures, &#39;self_exclude&#39;)</span>
<span class="n">nn_c</span> <span class="o">=</span> <span class="n">simple_classification_neural_network</span><span class="p">(</span><span class="n">train_measures</span><span class="p">,</span> <span class="n">test_measures</span><span class="p">,</span> <span class="s1">&#39;self_exclude&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/home/ojs/.local/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1221: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
</pre>
</div>
</div>

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sensitivity</th>
      <th>specificity</th>
      <th>accuracy</th>
      <th>precision</th>
      <th>auc</th>
      <th>odds_ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>nn_r</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.354</td>
      <td>0.354</td>
      <td>0.5</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Support-Vector-Machines-(SVMs)">Support Vector Machines (SVMs)<a class="anchor-link" href="#Support-Vector-Machines-(SVMs)"> </a></h2><p>The following cell uses <a href="https://scikit-learn.org/stable/modules/classes.html#module-sklearn.svm">scikit-learn's SVM</a> methods to create and trains some SVM's. The original paper uses Dimitriadou et al's <a href="https://www.researchgate.net/profile/Friedrich_Leisch/publication/221678005_E1071_Misc_Functions_of_the_Department_of_Statistics_E1071_TU_Wien/links/547305880cf24bc8ea19ad1d/E1071-Misc-Functions-of-the-Department-of-Statistics-E1071-TU-Wien.pdf">implementations in R described here</a>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">svm_e</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">machine_learning</span><span class="o">.</span><span class="n">svm_eps_regression</span><span class="p">(</span><span class="n">train_measures</span><span class="p">,</span> <span class="n">test_measures</span><span class="p">,</span> <span class="s1">&#39;self_exclude&#39;</span><span class="p">)</span>
<span class="n">svm_c</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">machine_learning</span><span class="o">.</span><span class="n">svm_c_classification</span><span class="p">(</span><span class="n">train_measures</span><span class="p">,</span> <span class="n">test_measures</span><span class="p">,</span> <span class="s1">&#39;self_exclude&#39;</span><span class="p">)</span>
<span class="n">svm_o</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">machine_learning</span><span class="o">.</span><span class="n">svm_one_classification</span><span class="p">(</span><span class="n">train_measures</span><span class="p">,</span> <span class="n">test_measures</span><span class="p">,</span> <span class="s1">&#39;self_exclude&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Random-Forest">Random Forest<a class="anchor-link" href="#Random-Forest"> </a></h2><p>This section implements <a href="https://scikit-learn.org/stable/modules/ensemble.html#forest">scikit-learn's ensemble methods</a> to create random forests for classification and regression</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rf_r</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">machine_learning</span><span class="o">.</span><span class="n">rf_regression</span><span class="p">(</span><span class="n">train_measures</span><span class="p">,</span> <span class="n">test_measures</span><span class="p">,</span> <span class="s1">&#39;self_exclude&#39;</span><span class="p">)</span>
<span class="n">rf_c</span> <span class="o">=</span> <span class="n">gb</span><span class="o">.</span><span class="n">machine_learning</span><span class="o">.</span><span class="n">rf_classification</span><span class="p">(</span><span class="n">train_measures</span><span class="p">,</span> <span class="n">test_measures</span><span class="p">,</span> <span class="s1">&#39;self_exclude&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="All-Methods-Together">All Methods Together<a class="anchor-link" href="#All-Methods-Together"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_labels</span> <span class="o">=</span> <span class="n">test_measures</span><span class="p">[</span><span class="s1">&#39;self_exclude&#39;</span><span class="p">]</span>
<span class="n">all_results</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">gb</span><span class="o">.</span><span class="n">machine_learning</span><span class="o">.</span><span class="n">compute_performance</span><span class="p">(</span><span class="s1">&#39;Logistic Regression&#39;</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">,</span> <span class="n">log_r</span><span class="p">),</span>
    <span class="n">gb</span><span class="o">.</span><span class="n">machine_learning</span><span class="o">.</span><span class="n">compute_performance</span><span class="p">(</span><span class="s1">&#39;Lasso Logistic Regression&#39;</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">,</span> <span class="n">lasso_l</span><span class="p">),</span>
    <span class="n">gb</span><span class="o">.</span><span class="n">machine_learning</span><span class="o">.</span><span class="n">compute_performance</span><span class="p">(</span><span class="s1">&#39;NN Regression&#39;</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">,</span> <span class="n">nn_r</span><span class="p">),</span>
    <span class="n">gb</span><span class="o">.</span><span class="n">machine_learning</span><span class="o">.</span><span class="n">compute_performance</span><span class="p">(</span><span class="s1">&#39;Same NN Again&#39;</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">,</span> <span class="n">nn_c</span><span class="p">),</span>
    <span class="n">gb</span><span class="o">.</span><span class="n">machine_learning</span><span class="o">.</span><span class="n">compute_performance</span><span class="p">(</span><span class="s1">&#39;SVM eps-Regression&#39;</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">,</span> <span class="n">svm_e</span><span class="p">),</span>
    <span class="n">gb</span><span class="o">.</span><span class="n">machine_learning</span><span class="o">.</span><span class="n">compute_performance</span><span class="p">(</span><span class="s1">&#39;SVM c-Classification&#39;</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">,</span> <span class="n">svm_c</span><span class="p">),</span>
    <span class="n">gb</span><span class="o">.</span><span class="n">machine_learning</span><span class="o">.</span><span class="n">compute_performance</span><span class="p">(</span><span class="s1">&#39;SVM one-Classification&#39;</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">,</span> <span class="n">svm_o</span><span class="p">),</span>
    <span class="n">gb</span><span class="o">.</span><span class="n">machine_learning</span><span class="o">.</span><span class="n">compute_performance</span><span class="p">(</span><span class="s1">&#39;RF Regression&#39;</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">,</span> <span class="n">rf_r</span><span class="p">),</span>
    <span class="n">gb</span><span class="o">.</span><span class="n">machine_learning</span><span class="o">.</span><span class="n">compute_performance</span><span class="p">(</span><span class="s1">&#39;RF Classification&#39;</span><span class="p">,</span> <span class="n">test_labels</span><span class="p">,</span> <span class="n">rf_c</span><span class="p">)</span>
<span class="p">]</span>

<span class="n">all_results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">all_results</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">all_results_df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-16-fc86f1fc89ad&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span>     gb<span class="ansi-blue-fg">.</span>machine_learning<span class="ansi-blue-fg">.</span>compute_performance<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;Logistic Regression&#39;</span><span class="ansi-blue-fg">,</span> test_labels<span class="ansi-blue-fg">,</span> log_r<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span>     gb<span class="ansi-blue-fg">.</span>machine_learning<span class="ansi-blue-fg">.</span>compute_performance<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;Lasso Logistic Regression&#39;</span><span class="ansi-blue-fg">,</span> test_labels<span class="ansi-blue-fg">,</span> lasso_l<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">----&gt; 5</span><span class="ansi-red-fg">     </span>gb<span class="ansi-blue-fg">.</span>machine_learning<span class="ansi-blue-fg">.</span>compute_performance<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;NN Regression&#39;</span><span class="ansi-blue-fg">,</span> test_labels<span class="ansi-blue-fg">,</span> nn_r<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">      6</span>     gb<span class="ansi-blue-fg">.</span>machine_learning<span class="ansi-blue-fg">.</span>compute_performance<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;Same NN Again&#39;</span><span class="ansi-blue-fg">,</span> test_labels<span class="ansi-blue-fg">,</span> nn_c<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">      7</span>     gb<span class="ansi-blue-fg">.</span>machine_learning<span class="ansi-blue-fg">.</span>compute_performance<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;SVM eps-Regression&#39;</span><span class="ansi-blue-fg">,</span> test_labels<span class="ansi-blue-fg">,</span> svm_e<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span>

<span class="ansi-red-fg">NameError</span>: name &#39;nn_r&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Visualisations">Visualisations<a class="anchor-link" href="#Visualisations"> </a></h1>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">plot_individual</span><span class="p">(</span><span class="n">measures_table</span><span class="p">,</span> <span class="n">player_id</span><span class="p">):</span>
    
    <span class="n">measure_cols</span> <span class="o">=</span> <span class="n">measures_table</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">player</span> <span class="o">=</span> <span class="n">measures_table</span><span class="p">[</span><span class="n">measures_table</span><span class="p">[</span><span class="s1">&#39;player_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">player_id</span><span class="p">]</span>
    
    <span class="k">for</span> <span class="n">measure</span> <span class="ow">in</span> <span class="n">measure_cols</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">hist</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">measures_table</span><span class="p">[</span><span class="n">measure</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">player</span><span class="p">[</span><span class="n">measure</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">player</span><span class="p">[</span><span class="n">measure</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">hist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span> <span class="n">label</span><span class="o">=</span><span class="n">measure</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
<span class="n">plot_individual</span><span class="p">(</span><span class="n">philander_data</span><span class="p">,</span> <span class="mi">1324368</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-1-9d53728362b2&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">     13</span>         plt<span class="ansi-blue-fg">.</span>show<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     14</span> 
<span class="ansi-green-fg">---&gt; 15</span><span class="ansi-red-fg"> </span>plot_individual<span class="ansi-blue-fg">(</span>philander_data<span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">1324368</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;philander_data&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

