---

title: Data


keywords: fastai
sidebar: home_sidebar

summary: "Load transaction data into a usable format"
description: "Load transaction data into a usable format"
nb_path: "20_data.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 20_data.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Overview">Overview<a class="anchor-link" href="#Overview"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The data module can be used to load in transaction data sets from multiple sources into a format that the gamba library can use. This format is is in preparation to create a measures table, and is simply a dataframe with fixed column names. Read through this page to find out how it works, plus some simple plotting at the end. This module also contains a number of data loading functions for existing public data repositories so you can replicate or extend work right from the start.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Reading-CSV-Files">Reading CSV Files<a class="anchor-link" href="#Reading-CSV-Files"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This can be done using the <a href="/gamba/data.html#read_csv"><code>read_csv</code></a> method, which is a wrapper around the <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html">pandas library's method</a> of the same name.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="read_csv" class="doc_header"><code>read_csv</code><a href="https://github.com/gamba-dev/gamba/tree/main/gamba/data.py#L9" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>read_csv</code>(<strong><code>file</code></strong>, <strong><code>parse_dates</code></strong>=<em><code>[]</code></em>, <strong><code>index_col</code></strong>=<em><code>None</code></em>, <strong><code>delimiter</code></strong>=<em><code>','</code></em>, <strong><code>dummy_data</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Read csv files into a pandas dataframe.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="concat" class="doc_header"><code>concat</code><a href="https://github.com/gamba-dev/gamba/tree/main/gamba/data.py#L18" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>concat</code>(<strong><code>dfs</code></strong>, <strong><code>axis</code></strong>=<em><code>0</code></em>)</p>
</blockquote>
<p>This method is a wrapper of pandas' <strong>concat</strong> function. See <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html">here</a> for details.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="add_tables" class="doc_header"><code>add_tables</code><a href="https://github.com/gamba-dev/gamba/tree/main/gamba/data.py#L25" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>add_tables</code>(<strong><code>t1</code></strong>, <strong><code>t2</code></strong>, <strong><code>same_columns</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Joins two tables (the second to the right hand side of the first), adding '_2' to column names if same_columns parameter is True.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This can be used to read a regular CSV file as you'd expect, but can also be used for tab-separated files - as some of <a href="http://www.thetransparencyproject.org/download_index.php">the transparency project</a>'s data sets are.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Setting-Column-Names">Setting Column Names<a class="anchor-link" href="#Setting-Column-Names"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The gamba library's methods expect a dataframe with certain column names. The most important task after loading data as a <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html">pandas dataframe</a> is to set these column names according to the type of data the column contains. These names should match the following table for basic data;</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table>
<thead><tr>
<th>Column Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><em>player_id</em></strong></td>
<td>a unique identifier for each player</td>
</tr>
<tr>
<td><strong><em>bet_size</em></strong></td>
<td>the size of the bet (in raw currency form, e.g. USD)</td>
</tr>
<tr>
<td><strong><em>bet_time</em></strong></td>
<td>the datetime the bet was placed</td>
</tr>
<tr>
<td><strong><em>payout_size</em></strong></td>
<td>the size of the payout (also in raw currency)</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Advanced data sets may contain more information about each bet. These additional columns can be included using names from the table below. Note that methods in other parts of the library will reject dataframes which contain column names not in one these two tables.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table>
<thead><tr>
<th>Column Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><em>payout_time</em></strong></td>
<td>the <a href="(https://www.unixtimestamp.com/">timestamp</a> that the payout was paid</td>
</tr>
<tr>
<td><strong><em>decimal_odds</em></strong></td>
<td>the <a href="https://en.wikipedia.org/wiki/Odds#Decimal_odds">decimal odds</a> for the given bet</td>
</tr>
<tr>
<td><strong><em>house_edge</em></strong></td>
<td>the percentage taken by the house (value of 3 for 3% house edge)</td>
</tr>
<tr>
<td><strong><em>game_type</em></strong></td>
<td>the game being played as a string e.g. 'coinflip', 'roulette' - doesn't have to be one of a fixed set but should be unique per game type</td>
</tr>
<tr>
<td><strong><em>provider</em></strong></td>
<td>the operator's name - this is useful for mixed operator datasets</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Loading-Existing-Datasets">Loading Existing Datasets<a class="anchor-link" href="#Loading-Existing-Datasets"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Several public repositories provide transaction data that can be loaded by the gamba library (see Public Repositories in the menu). The data module contains methods for loading some of these sets into the correct format, which are used in the respective replications. If you're loading in a similar data set, feel free to explore the source code of these methods to see how it's done, and modify them for your own needs!</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="prepare_labrie_data" class="doc_header"><code>prepare_labrie_data</code><a href="https://github.com/gamba-dev/gamba/tree/main/gamba/data.py#L34" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>prepare_labrie_data</code>(<strong><code>filename</code></strong>, <strong><code>savedir</code></strong>=<em><code>'labrie_individuals/'</code></em>, <strong><code>loud</code></strong>=<em><code>False</code></em>, <strong><code>year</code></strong>=<em><code>2008</code></em>)</p>
</blockquote>
<p>Splits the original labrie data into CSV files for each individual's transactions and renames the columns to be compatable with the rest of the gamba library.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="prepare_braverman_data" class="doc_header"><code>prepare_braverman_data</code><a href="https://github.com/gamba-dev/gamba/tree/main/gamba/data.py#L79" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>prepare_braverman_data</code>(<strong><code>filename</code></strong>, <strong><code>loud</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Splits the original Braverman and Shaffer data into CSV files for each indivdiual's transactions, and renames the columns to be compatable with the rest of the gamba library.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="prepare_philander_data" class="doc_header"><code>prepare_philander_data</code><a href="https://github.com/gamba-dev/gamba/tree/main/gamba/data.py#L102" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>prepare_philander_data</code>(<strong><code>filename</code></strong>, <strong><code>loud</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Loads in the analytic data set of high-risk internet gamblers and removes the UserID, Sereason, random, and clustering columns as described in Philander's 2014 study.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Final-Checks">Final Checks<a class="anchor-link" href="#Final-Checks"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It's good practice to check that your column names match those used by the gamba library, and make sure that no extra columns exist. The <a href="/gamba/data.html#check_data"><code>check_data</code></a> method below can be given the dataframe, and it will raise an error if anything isn't as it should be;</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="check_data" class="doc_header"><code>check_data</code><a href="https://github.com/gamba-dev/gamba/tree/main/gamba/data.py#L118" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>check_data</code>(<strong><code>dataframe</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="summarise_app" class="doc_header"><code>summarise_app</code><a href="https://github.com/gamba-dev/gamba/tree/main/gamba/data.py#L130" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>summarise_app</code>(<strong><code>player_bets</code></strong>, <strong><code>dapp</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Prints out some basic information about a gambling or gambling-like application given a collection of bets made through that application. Data displayed includes the number of users, the number of game types provided, the number of bets placed, the total value of the bets and the payouts, the time of the first bet, and the time of the last.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="summarise_providers" class="doc_header"><code>summarise_providers</code><a href="https://github.com/gamba-dev/gamba/tree/main/gamba/data.py#L161" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>summarise_providers</code>(<strong><code>player_bets</code></strong>, <strong><code>providers</code></strong>, <strong><code>game_types</code></strong>=<em><code>['coinflip', 'onedice', 'twodice', 'roll']</code></em>)</p>
</blockquote>
<p>Create a table containing summary data for providers using a collection of player bets. Summary includes the number of unique users and games, the total value of bets and payouts, the starting and ending block numbers, and the time the starting and ending blocks ocurred.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Plotting">Plotting<a class="anchor-link" href="#Plotting"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The data module contains some basic visualisation methods which can be applied before any behavioural measures are calculated. This is useful for showing the distributions of player bet sizes, times, payouts, and so on.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_player_career" class="doc_header"><code>plot_player_career</code><a href="https://github.com/gamba-dev/gamba/tree/main/gamba/data.py#L190" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_player_career</code>(<strong><code>player_df</code></strong>, <strong><code>savename</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Creates a candlestick-style plot of a players betting activity over the course of their career. This works best on regularly-spaced sequential data but can also provide insight into intra-session win/loss patterns.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_player_career_split" class="doc_header"><code>plot_player_career_split</code><a href="https://github.com/gamba-dev/gamba/tree/main/gamba/data.py#L227" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_player_career_split</code>(<strong><code>player_df</code></strong>)</p>
</blockquote>
<p>Plot a player's betting and payout trajectory on a single plot, with green indicating payouts (top) and red indicating bets (bottom). A cumulative value line is also plotted between the two. Note that the player_df must include both</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_provider_dates" class="doc_header"><code>plot_provider_dates</code><a href="https://github.com/gamba-dev/gamba/tree/main/gamba/data.py#L276" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_provider_dates</code>(<strong><code>player_bets</code></strong>, <strong><code>providers</code></strong>, <strong><code>provider_labels</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Visualises the start and end dates of bets from one or more providers on a stacked gantt style plot.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_provider_bets" class="doc_header"><code>plot_provider_bets</code><a href="https://github.com/gamba-dev/gamba/tree/main/gamba/data.py#L306" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_provider_bets</code>(<strong><code>player_bets</code></strong>, <strong><code>providers</code></strong>, <strong><code>provider_labels</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Visualises the cumulative number of bets from one or more providers.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

